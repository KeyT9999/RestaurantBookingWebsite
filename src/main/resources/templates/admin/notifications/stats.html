<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="vi">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Thống kê thông báo - BookEat Admin</title>
	
	<!-- Bootstrap 5 CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	
	<!-- Font Awesome -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
	
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	
	<!-- Design System -->
	<link th:href="@{/css/design-system.css}" rel="stylesheet">
	<link th:href="@{/css/admin-dashboard.css}" rel="stylesheet">
	
	<style>
		body {
			font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
			background-color: #F9FAFB;
		}
		
		/* Hide search dropdown on admin pages */
		.header-search {
			display: none !important;
		}
		
		.search-dropdown {
			display: none !important;
		}
		
		/* Clean admin header */
		.ds-user-actions a[href*="restaurant-owner/restaurants/create"] {
			display: none !important;
		}
		
		.ds-user-actions .dropdown.dropdown-hover:not(.ds-admin-dropdown) {
			display: none !important;
		}
		
		main {
			padding-top: 100px;
		}
		
		.section-title { 
			color: #1F2937; 
			font-family: 'Inter', sans-serif; 
			font-weight: 700; 
			font-size: 2.2rem; 
		}
		
		/* Cards */
		.stats-card { 
			background: white; 
			border: 1px solid #E5E7EB; 
			color: #1F2937; 
			border-radius: 12px; 
			transition: all 0.2s; 
			box-shadow: 0 1px 3px rgba(0,0,0,0.1); 
		}
		
		.stats-card:hover { 
			transform: translateY(-2px); 
			box-shadow: 0 4px 6px rgba(0,0,0,0.15); 
			border-color: #3B82F6; 
		}
		
		.stats-icon { 
			width: 64px; 
			height: 64px; 
			border-radius: 50%; 
			background: #EFF6FF; 
			color: #3B82F6; 
			display: flex; 
			align-items: center; 
			justify-content: center; 
			font-weight: 700; 
			font-size: 1.5rem; 
		}
		
		.stats-number { 
			font-size: 2.2rem; 
			font-weight: 700; 
			color: #3B82F6; 
		}
		
		.stats-label { 
			color: #6B7280; 
			font-size: 0.9rem; 
		}
		
		.btn-gold { 
			background: #3B82F6; 
			border-color: #3B82F6; 
			color: white; 
		}
		
		.btn-gold:hover { 
			background: #2563EB; 
			border-color: #2563EB; 
			color: white; 
		}
	</style>
</head>
<body>
	<!-- Unified Header -->
	<div th:with="activeNav='admin-notifications'" 
	     th:replace="~{fragments/design-system-components :: unified-header}"></div>
	
	<!-- Flash Messages -->
	<div th:insert="fragments/flash :: flash"></div>
	
	<main>
		<div class="container py-5">
			<div class="d-flex align-items-center mb-4">
				<a th:href="@{/admin/notifications}" class="btn btn-outline-secondary me-3">
					<i class="fas fa-arrow-left"></i>
				</a>
				<h1 class="section-title mb-0">
					<i class="fas fa-chart-bar text-primary me-2"></i> Thống kê thông báo
				</h1>
			</div>

			<div class="row g-4">
				<div class="col-lg-3 col-md-6">
					<div class="stats-card p-4 text-center">
						<div class="stats-icon mx-auto mb-3">
							<i class="fas fa-paper-plane"></i>
						</div>
						<div class="stats-number" th:text="${totalSent}">0</div>
						<div class="stats-label">Tổng số đã gửi</div>
					</div>
				</div>

				<div class="col-lg-3 col-md-6">
					<div class="stats-card p-4 text-center">
						<div class="stats-icon mx-auto mb-3">
							<i class="fas fa-eye"></i>
						</div>
						<div class="stats-number text-success" th:text="${totalRead}">0</div>
						<div class="stats-label">Đã đọc</div>
					</div>
				</div>

				<div class="col-lg-3 col-md-6">
					<div class="stats-card p-4 text-center">
						<div class="stats-icon mx-auto mb-3">
							<i class="fas fa-eye-slash"></i>
						</div>
						<div class="stats-number text-warning" th:text="${totalUnread}">0</div>
						<div class="stats-label">Chưa đọc</div>
					</div>
				</div>

				<div class="col-lg-3 col-md-6">
					<div class="stats-card p-4 text-center">
						<div class="stats-icon mx-auto mb-3">
							<i class="fas fa-percentage"></i>
						</div>
						<div class="stats-number text-info" th:text="${totalSent > 0 ? #numbers.formatDecimal(totalRead * 100.0 / totalSent, 1, 1) : 0}">0</div>
						<div class="stats-label">Tỷ lệ đọc (%)</div>
					</div>
				</div>
			</div>

			<div class="row mt-5">
				<div class="col-12">
					<div class="stats-card p-4">
						<h4 class="mb-4">
							<i class="fas fa-info-circle me-2 text-primary"></i> Thông tin hệ thống
						</h4>
						<div class="row g-3">
							<div class="col-md-6">
								<div class="d-flex justify-content-between">
									<span class="text-muted">Tổng số thông báo:</span>
									<strong th:text="${totalSent}">0</strong>
								</div>
							</div>
							<div class="col-md-6">
								<div class="d-flex justify-content-between">
									<span class="text-muted">Đã đọc:</span>
									<strong class="text-success" th:text="${totalRead}">0</strong>
								</div>
							</div>
							<div class="col-md-6">
								<div class="d-flex justify-content-between">
									<span class="text-muted">Chưa đọc:</span>
									<strong class="text-warning" th:text="${totalUnread}">0</strong>
								</div>
							</div>
							<div class="col-md-6">
								<div class="d-flex justify-content-between">
									<span class="text-muted">Tỷ lệ đọc:</span>
									<strong class="text-info" th:text="${totalSent > 0 ? #numbers.formatDecimal(totalRead * 100.0 / totalSent, 1, 1) + '%' : '0%'}">0%</strong>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="row mt-4">
				<div class="col-12 text-center">
					<a th:href="@{/admin/notifications}" class="btn btn-gold me-2">
						<i class="fas fa-list me-1"></i> Quay lại danh sách
					</a>
					<a th:href="@{/admin/notifications/new}" class="btn btn-outline-secondary">
						<i class="fas fa-plus me-1"></i> Tạo thông báo mới
					</a>
				</div>
			</div>
		</div>
	</main>

	<!-- Footer -->
	<div th:replace="~{fragments/design-system-components :: unified-footer}"></div>
	
	<!-- Scripts -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script th:src="@{/js/main.js}" defer></script>
</body>
</html>
