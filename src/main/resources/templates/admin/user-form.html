<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>User Form - BookEat Admin</title>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
	<link th:href="@{/css/design-system.css}" rel="stylesheet">
	<link th:href="@{/css/luxury.css}" rel="stylesheet">
	
	<style>
		/* Admin Panel Specific Styles */
		.admin-page { 
			font-family: 'Inter', sans-serif; 
			background: #121212; 
			color: #fff; 
			min-height: 100vh;
		}
		
		.form-container { 
			background: #1A1A1A; 
			border-radius: 16px; 
			border: 1px solid rgba(212,175,55,.2);
			box-shadow: 0 8px 32px rgba(0,0,0,0.3);
		}
		
		.form-control, .form-select { 
			background: #2A2A2A; 
			color: #E0E0E0; 
			border: 1px solid #444;
			font-family: 'Inter', sans-serif;
			font-size: 0.95rem;
			padding: 0.75rem 1rem;
			border-radius: 8px;
			transition: all 0.2s ease;
		}
		
		.form-control:focus, .form-select:focus { 
			background: #2A2A2A; 
			color: #E0E0E0; 
			border-color: #D4AF37; 
			box-shadow: 0 0 0 0.2rem rgba(212,175,55,.25);
		}
		
		.btn-gold { 
			background: #D4AF37; 
			border-color: #D4AF37; 
			color: #121212; 
			font-weight: 600; 
		}
		
		.btn-gold:hover { 
			background: #FFD700; 
			border-color: #FFD700; 
			color: #121212;
		}
		
		/* Label m√†u tr·∫Øng */
		.form-label { color: #ffffff !important; font-weight: 500; }
		
		/* Text muted cho dark theme */
		.text-muted { color: #BFBFBF !important; }
		
		/* Password field styling */
		.password-note {
			color: #ffffff !important;
			font-size: 0.875rem;
		}
		
		.alert-info {
			background: rgba(212,175,55,0.15) !important;
			border: 1px solid rgba(212,175,55,0.4) !important;
			color: #ffffff !important;
		}
		
		.text-danger { color: #ff6b6b !important; }
		
		.alert-success {
			background: rgba(40,167,69,0.2) !important;
			border: 1px solid rgba(40,167,69,0.4) !important;
			color: #ffffff !important;
		}
		
		/* Page title styling */
		.page-title {
			color: #D4AF37;
			font-family: 'Poppins', sans-serif;
			font-weight: 600;
			font-size: 2rem;
			text-align: center;
			margin-bottom: 0.5rem;
		}
		
		.page-subtitle {
			color: #BFBFBF;
			text-align: center;
			margin-bottom: 32px;
		}
		
		/* Adjust container for fixed header */
		.admin-content {
			padding-top: 120px; /* Account for fixed header */
		}
	</style>
</head>
<body class="admin-page">
	<!-- Site Header -->
	<div th:with="activeNav='admin-users'"
	     th:replace="~{fragments/design-system-components :: unified-header}"></div>

	<!-- Admin Content -->
	<div class="admin-content">
		<div class="container py-5">
			<div class="row justify-content-center">
				<div class="col-lg-8">
					
					<!-- Page Header -->
					<div class="mb-5">
						<h1 class="page-title">
							<i class="fas fa-user-edit me-3"></i>
							<span th:text="${userId != null} ? 'Ch·ªânh s·ª≠a ng∆∞·ªùi d√πng' : 'Th√™m ng∆∞·ªùi d√πng m·ªõi'">User Management</span>
						</h1>
						<p class="page-subtitle">Qu·∫£n l√Ω th√¥ng tin ng∆∞·ªùi d√πng trong h·ªá th·ªëng BookEat</p>
					</div>

					<!-- Main Form -->
					<div class="card form-container p-4">
						<form th:action="${userId != null} ? @{'/admin/users/' + ${userId}}" : @{/admin/users/create} 
							  method="post" th:object="${form}">
								  
							<!-- Basic Information Section -->
							<div class="mb-4">
								<h5 class="text-light mb-3">
									<i class="fas fa-id-card me-2"></i>
									Th√¥ng tin c∆° b·∫£n
								</h5>
							</div>
							  
							<!-- Username & Email -->
							<div class="row mb-4">
								<div class="col-md-6">
									<label class="form-label">T√™n ƒëƒÉng nh·∫≠p *</label>
									<input type="text" class="form-control" th:field="*{username}" 
										   placeholder="Nh·∫≠p username..." th:value="${form?.username}">
									<div class="text-danger small mt-1" th:errors="*{username}"></div>
								</div>
								<div class="col-md-6">
									<label class="form-label">ƒê·ªãa ch·ªâ Email *</label>
									<input type="email" class="form-control" th:field="*{email}" 
										   placeholder="email@example.com" th:value="${form?.email}">
									<div class="text-danger small mt-1" th:errors="*{email}"></div>
								</div>
							</div>

							<!-- Password Section -->
							<div th:if="${userId != null}">
								<div class="mb-4">
									<h5 class="text-light mb-3">
										<i class="fas fa-key me-2"></i>
										B·∫£o m·∫≠t
									</h5>
								</div>
								
								<div class="row mb-3">
									<div class="col-md-6">
										<label class="form-label">M·∫≠t kh·∫©u m·ªõi (ƒë·ªÉ tr·ªëng n·∫øu kh√¥ng ƒë·ªïi)</label>
										<input type="password" class="form-control" th:field="*{newPassword}" 
											   placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi..." autocomplete="new-password">
										<div class="text-danger small mt-1" th:errors="*{newPassword}"></div>
										<div class="password-note small mt-1">
											<i class="fas fa-info-circle me-1"></i>
											Ch·ªâ nh·∫≠p khi mu·ªën thay ƒë·ªïi m·∫≠t kh·∫©u
										</div>
									</div>
									<div class="col-md-6">
										<label class="form-label">L∆∞u √Ω b·∫£o m·∫≠t</label>
										<div class="alert alert-info py-3">
											<i class="fas fa-shield-alt me-2"></i>
											ƒê·ªÉ tr·ªëng √¥ m·∫≠t kh·∫©u ƒë·ªÉ gi·ªØ nguy√™n m·∫≠t kh·∫©u hi·ªán t·∫°i
										</div>
									</div>
								</div>
							</div>

							<!-- Password for create mode -->
							<div class="row mb-4" th:if="${userId == null}">
								<div class="col-md-6">
									<label class="form-label">M·∫≠t kh·∫©u *</label>
									<input type="password" class="form-control" th:field="*{password}" 
										   placeholder="M·∫≠t kh·∫©u t·ªëi thi·ªÉu 6 k√Ω t·ª±">
									<div class="text-danger small mt-1" th:errors="*{password}"></div>
								</div>
							</div>

							<!-- Personal Information Section -->
							<div class="mb-4 mt-5">
								<h5 class="text-light mb-3">
									<i class="fas fa-user me-2"></i>
									Th√¥ng tin c√° nh√¢n
								</h5>
							</div>

							<!-- Full Name & Phone -->
							<div class="row mb-4">
								<div class="col-md-6">
									<label class="form-label">H·ªç v√† t√™n *</label>
									<input type="text" class="form-control" th:field="*{fullName}" 
										   placeholder="Nh·∫≠p h·ªç t√™n ƒë·∫ßy ƒë·ªß" th:value="${form?.fullName}">
									<div class="text-danger small mt-1" th:errors="*{fullName}"></div>
								</div>
								<div class="col-md-6">
									<label class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
									<input type="tel" class="form-control" th:field="*{phoneNumber}" 
										   placeholder="090..." th:value="${form?.phoneNumber}">
								</div>
							</div>

							<!-- Address -->
							<div class="row mb-4">
								<div class="col-md-12">
									<label class="form-label">ƒê·ªãa ch·ªâ</label>
									<input type="text" class="form-control" th:field="*{address}" 
										   placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ c·ª• th·ªÉ" th:value="${form?.address}">
								</div>
							</div>

							<!-- Account Settings Section -->
							<div class="mb-4 mt-5">
								<h5 class="text-light mb-3">
									<i class="fas fa-cog me-2"></i>
									C√†i ƒë·∫∑t t√†i kho·∫£n
								</h5>
							</div>

							<!-- Role & Status -->
							<div class="row mb-4">
								<div class="col-md-4">
									<label class="form-label">Vai tr√≤ *</label>
									<select class="form-select" th:field="*{role}">
										<option value="">-- Ch·ªçn vai tr√≤ --</option>
										<option th:each="r : ${roles}" 
												th:value="${r}" 
												th:text="${r.getValue().toUpperCase()}"
												th:selected="${form?.role == r}"></option>
									</select>
								</div>
								<div class="col-md-4">
									<label class="form-label">Tr·∫°ng th√°i Email</label>
									<select class="form-select" th:field="*{emailVerified}">
										<option value="true" th:selected="${form?.emailVerified == true}">‚úÖ ƒê√£ x√°c th·ª±c</option>
										<option value="false" th:selected="${form?.emailVerified == false}">‚ùå Ch∆∞a x√°c th·ª±c</option>
									</select>
								</div>
								<div class="col-md-4" th:if="${userId != null}">
									<label class="form-label">Tr·∫°ng th√°i t√†i kho·∫£n</label>
									<select class="form-select" th:field="*{active}">
										<option value="true" th:selected="${form?.active == true}">üü¢ Ho·∫°t ƒë·ªông</option>
										<option value="false" th:selected="${form?.active == false}">üî¥ B·ªã kh√≥a</option>
									</select>
								</div>
							</div>

							<!-- Submit Buttons -->
							<div class="row mb-0 mt-5 pt-3">
								<div class="col-12 text-center">
									<button class="btn btn-gold btn-lg me-3" type="submit">
										<i class="fas fa-save me-2"></i> 
										<span th:text="${userId != null} ? 'C·∫≠p nh·∫≠t ng∆∞·ªùi d√πng' : 'T·∫°o ng∆∞·ªùi d√πng m·ªõi'">L∆∞u thay ƒë·ªïi</span>
									</button>
									<a class="btn btn-outline-light btn-lg" th:href="@{/admin/users}">
										<i class="fas fa-arrow-left me-2"></i> Quay l·∫°i
									</a>
								</div>
							</div>
						</form>
					</div>

					<!-- Success Message -->
					<div th:if="${param.success}" class="alert alert-success mt-4">
						<i class="fas fa-check-circle me-2"></i>
						<span th:text="${param.success[0] == 'updated'} ? 'ƒê√£ c·∫≠p nh·∫≠t th√¥ng tin ng∆∞·ªùi d√πng th√†nh c√¥ng!' : 'ƒê√£ t·∫°o ng∆∞·ªùi d√πng m·ªõi th√†nh c√¥ng!'">Th√†nh c√¥ng!</span>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Site Footer -->
	<div th:replace="~{fragments/design-system-components :: unified-footer}"></div>
	<div th:replace="~{fragments/resy-scripts :: basic-scripts}"></div>
	
	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 
