<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title th:text="${pageTitle}">Qu·∫£n l√Ω B√†n - Table Management</title>
    <link rel="stylesheet" href="/css/restaurant-admin.css" />
</head>
<body>
    <nav class="page-switch card">
        <a class="nav-btn" href="/restaurant-owner/dashboard" title="V·ªÅ FOH Dashboard">‚Üê FOH Dashboard</a>
        <a class="nav-btn" href="/restaurant-owner/profile" title="H·ªì s∆° Nh√† h√†ng">‚Üí H·ªì s∆° Nh√† h√†ng</a>
    </nav>

    <div class="container">
        <header class="nav card">
            <div class="nav-left">
                <h1 class="h1">Qu·∫£n l√Ω B√†n</h1>
                <p class="muted">Qu·∫£n l√Ω s·ª©c ch·ª©a, tr·∫°ng th√°i v√† b·ªë tr√≠ b√†n</p>
            </div>
            <div class="actions">
                <button class="btn" data-open="panel-create-table">+ T·∫°o b√†n m·ªõi</button>
                <button class="btn btn-ghost">Import t·ª´ Excel</button>
            </div>
        </header>

        <!-- Filters -->
        <div class="card">
            <h2 class="h2">B·ªô l·ªçc</h2>
            <form class="grid grid-4">
                <label class="form-item">
                    <span class="form-label">Khu v·ª±c</span>
                    <select class="input">
                        <option value="">T·∫•t c·∫£ khu v·ª±c</option>
                        <option>T·∫ßng 1</option>
                        <option>T·∫ßng 2</option>
                        <option>Ngo√†i tr·ªùi</option>
                        <option>VIP</option>
                    </select>
                </label>
                <label class="form-item">
                    <span class="form-label">S·ª©c ch·ª©a</span>
                    <select class="input">
                        <option value="">T·∫•t c·∫£ s·ª©c ch·ª©a</option>
                        <option>1-2 ng∆∞·ªùi</option>
                        <option>3-4 ng∆∞·ªùi</option>
                        <option>5-6 ng∆∞·ªùi</option>
                        <option>7+ ng∆∞·ªùi</option>
                    </select>
                </label>
                <label class="form-item">
                    <span class="form-label">Tr·∫°ng th√°i</span>
                    <select class="input">
                        <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                        <option>AVAILABLE</option>
                        <option>OCCUPIED</option>
                        <option>RESERVED</option>
                        <option>MAINTENANCE</option>
                    </select>
                </label>
                <label class="form-item">
                    <span class="form-label">T√¨m ki·∫øm</span>
                    <input type="text" placeholder="T√™n b√†n, ghi ch√∫..." />
                </label>
            </form>
            <div class="actions">
                <button class="btn">L·ªçc</button>
                <button class="btn btn-ghost">X√≥a l·ªçc</button>
                <div class="spacer"></div>
                <a th:href="@{/restaurant-owner/tables/create}" class="btn">+ T·∫°o b√†n m·ªõi</a>
                <button class="btn btn-ghost">Xu·∫•t Excel</button>
            </div>
        </div>

        <!-- Table Management -->
        <div class="card">
            <h2 class="h2">Danh s√°ch b√†n</h2>
            <div class="table-wrap">
                <table class="table">
                    <thead>
                        <tr>
                            <th>T√™n b√†n</th>
                            <th>S·ª©c ch·ª©a</th>
                            <th>Khu v·ª±c</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>Ghi ch√∫</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Flash Messages -->
                        <tr th:if="${success}" colspan="6">
                            <td colspan="6" class="alert alert-success" th:text="${success}"></td>
                        </tr>
                        <tr th:if="${error}" colspan="6">
                            <td colspan="6" class="alert alert-danger" th:text="${error}"></td>
                        </tr>
                        
                        <!-- Real data from database -->
                        <tr th:each="table : ${allTables}">
                            <td><strong th:text="${table.tableName}">T1</strong></td>
                            <td th:text="${table.capacity} + ' ng∆∞·ªùi'">4 ng∆∞·ªùi</td>
                            <td th:text="${table.area}">T·∫ßng 1</td>
                            <td>
                                <span class="chip" 
                                      th:style="${table.status.toString() == 'AVAILABLE'} ? 'background: #d4edda; color: #155724;' : 
                                                (${table.status.toString() == 'OCCUPIED'} ? 'background: #f8d7da; color: #721c24;' : 
                                                'background: #fff3cd; color: #856404;')"
                                      th:text="${table.status}">AVAILABLE</span>
                            </td>
                            <td th:text="${table.notes}">B√†n g·∫ßn c·ª≠a s·ªï</td>
                            <td class="actions">
                                <a th:href="@{'/restaurant-owner/tables/' + ${table.tableId} + '/edit'}" class="btn btn-ghost small">S·ª≠a</a>
                                <form th:action="@{'/restaurant-owner/tables/' + ${table.tableId} + '/delete'}" method="post" style="display: inline;">
                                    <button type="submit" class="btn btn-ghost small" onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a b√†n n√†y?')">X√≥a</button>
                                </form>
                            </td>
                        </tr>
                        
                        <!-- Empty state -->
                        <tr th:if="${#lists.isEmpty(allTables)}">
                            <td colspan="6" class="text-center text-muted">
                                <div style="padding: 2rem;">
                                    <div style="font-size: 3rem; margin-bottom: 1rem;">ü™ë</div>
                                    <h3>Ch∆∞a c√≥ b√†n n√†o</h3>
                                    <p>T·∫°o b√†n ƒë·∫ßu ti√™n cho nh√† h√†ng c·ªßa b·∫°n!</p>
                                    <a th:href="@{/restaurant-owner/tables/create}" class="btn">+ T·∫°o b√†n m·ªõi</a>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <button class="btn btn-ghost">¬´ Tr∆∞·ªõc</button>
                <span class="muted">Trang 1/3</span>
                <button class="btn btn-ghost">Sau ¬ª</button>
            </div>
        </div>

        <!-- Statistics -->
        <div class="grid grid-4">
            <div class="card">
                <h3 class="h3">T·ªïng s·ªë b√†n</h3>
                <p style="font-size: 2rem; margin: 0; color: #007bff;">24</p>
            </div>
            <div class="card">
                <h3 class="h3">ƒêang s·ª≠ d·ª•ng</h3>
                <p style="font-size: 2rem; margin: 0; color: #dc3545;">8</p>
            </div>
            <div class="card">
                <h3 class="h3">C√≥ s·∫µn</h3>
                <p style="font-size: 2rem; margin: 0; color: #28a745;">14</p>
            </div>
            <div class="card">
                <h3 class="h3">B·∫£o tr√¨</h3>
                <p style="font-size: 2rem; margin: 0; color: #ffc107;">2</p>
            </div>
        </div>
    </div>

    <!-- Modal: Create Table -->
    <aside class="panel" id="panel-create-table" aria-hidden="true">
        <div class="panel__body card">
            <div class="panel__head">
                <h3 class="h3">T·∫°o B√†n M·ªõi</h3>
                <button class="btn btn-ghost" data-close>ƒê√≥ng</button>
            </div>
            <form class="grid grid-3">
                <label class="form-item">
                    <span class="form-label">T√™n b√†n</span>
                    <input type="text" placeholder="VD: T1, VIP1" required />
                </label>
                <label class="form-item">
                    <span class="form-label">S·ª©c ch·ª©a</span>
                    <input type="number" min="1" max="20" value="4" required />
                </label>
                <label class="form-item">
                    <span class="form-label">Khu v·ª±c</span>
                    <select required>
                        <option value="">Ch·ªçn khu v·ª±c</option>
                        <option>T·∫ßng 1</option>
                        <option>T·∫ßng 2</option>
                        <option>Ngo√†i tr·ªùi</option>
                        <option>VIP</option>
                    </select>
                </label>
                <label class="form-item">
                    <span class="form-label">Tr·∫°ng th√°i</span>
                    <select>
                        <option value="AVAILABLE">AVAILABLE</option>
                        <option value="OCCUPIED">OCCUPIED</option>
                        <option value="RESERVED">RESERVED</option>
                        <option value="MAINTENANCE">MAINTENANCE</option>
                    </select>
                </label>
                <label class="form-item full">
                    <span class="form-label">Ghi ch√∫</span>
                    <textarea rows="3" placeholder="M√¥ t·∫£ ƒë·∫∑c ƒëi·ªÉm b√†n..."></textarea>
                </label>
                <div class="actions full">
                    <button class="btn">T·∫°o b√†n</button>
                    <button class="btn btn-ghost" type="reset">Nh·∫≠p l·∫°i</button>
                </div>
            </form>
        </div>
    </aside>

    <!-- Modal: Edit Table -->
    <aside class="panel" id="panel-edit-table" aria-hidden="true">
        <div class="panel__body card">
            <div class="panel__head">
                <h3 class="h3">S·ª≠a B√†n</h3>
                <button class="btn btn-ghost" data-close>ƒê√≥ng</button>
            </div>
            <form class="grid grid-3">
                <label class="form-item">
                    <span class="form-label">T√™n b√†n</span>
                    <input type="text" value="T1" required />
                </label>
                <label class="form-item">
                    <span class="form-label">S·ª©c ch·ª©a</span>
                    <input type="number" value="4" min="1" max="20" required />
                </label>
                <label class="form-item">
                    <span class="form-label">Khu v·ª±c</span>
                    <select required>
                        <option value="T·∫ßng 1" selected>T·∫ßng 1</option>
                        <option>T·∫ßng 2</option>
                        <option>Ngo√†i tr·ªùi</option>
                        <option>VIP</option>
                    </select>
                </label>
                <label class="form-item">
                    <span class="form-label">Tr·∫°ng th√°i</span>
                    <select>
                        <option value="AVAILABLE" selected>AVAILABLE</option>
                        <option value="OCCUPIED">OCCUPIED</option>
                        <option value="RESERVED">RESERVED</option>
                        <option value="MAINTENANCE">MAINTENANCE</option>
                    </select>
                </label>
                <label class="form-item full">
                    <span class="form-label">Ghi ch√∫</span>
                    <textarea rows="3">B√†n g·∫ßn c·ª≠a s·ªï</textarea>
                </label>
                <div class="actions full">
                    <button class="btn">C·∫≠p nh·∫≠t</button>
                    <button class="btn btn-ghost">X√≥a b√†n</button>
                </div>
            </form>
        </div>
    </aside>

    <script>
        // M·ªü/ƒë√≥ng panel
        document.querySelectorAll("[data-open]").forEach((b) => {
            b.addEventListener("click", () => {
                const id = b.getAttribute("data-open");
                const panel = document.getElementById(id);
                if (panel) panel.setAttribute("aria-hidden", "false");
            });
        });
        
        document.querySelectorAll("[data-close]").forEach((b) => {
            b.addEventListener("click", () => {
                const panel = b.closest(".panel");
                panel && panel.setAttribute("aria-hidden", "true");
            });
        });
    </script>
</body>
</html>
