<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Thông báo của tôi - BookEat</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	<link th:href="@{/css/design-system.css}" rel="stylesheet">
	<link th:href="@{/css/luxury.css}" rel="stylesheet">
	<style>
		/* Page baseline light/blue */
		.page-bg { background-color: var(--background-light); min-height:100vh; }
		.section-title { color: var(--text-dark); font-family: var(--font-heading); font-weight: 700; }
		
		.notification-card { background: var(--background-white); border:1px solid var(--border-light); color: var(--text-dark); border-radius:12px; transition: var(--transition); margin-bottom:1rem; box-shadow: var(--shadow-card); }
		.notification-card:hover { transform:translateY(-3px); box-shadow: var(--shadow-hover); border-color: var(--primary-blue); }
		.notification-card.unread { border-left:4px solid var(--primary-blue); }
		.badge-role, .badge-status { font-size:.8rem; }
		.table-muted { color: var(--text-light); }
		
		.pagination .page-link { background: var(--background-white); color: var(--primary-blue); border-color: var(--border-light); }
		.pagination .page-item.active .page-link { background: var(--primary-blue); color:#fff; border-color: var(--primary-blue); }
		.pagination .page-link:hover { background: var(--background-light); color: var(--primary-blue-dark); }
		
		.btn-gold { background: var(--primary-blue); border-color: var(--primary-blue); color:#fff; box-shadow: var(--shadow-button); }
		.btn-gold:hover { background: var(--primary-blue-dark); border-color: var(--primary-blue-dark); box-shadow: var(--shadow-hover); transform: translateY(-1px); }
		
		.notification-icon { width:48px; height:48px; border-radius:50%; background: var(--background-light); color: var(--primary-blue); display:flex; align-items:center; justify-content:center; font-weight:700; font-size:1.2rem; }
		.empty-state { text-align:center; padding:4rem 2rem; }
		.empty-icon { width:80px; height:80px; border-radius:50%; background:rgba(74,144,226,.1); color: var(--primary-blue); display:flex; align-items:center; justify-content:center; font-size:2rem; margin:0 auto 1.5rem; }
	</style>
</head>
<body class="page-bg">
	<div th:insert="fragments/flash :: flash"></div>
	<div th:with="activeNav='notifications'" th:replace="~{fragments/design-system-components :: unified-header}"></div>

	<div class="admin-content py-4">
		<div class="container">
			<div class="d-flex align-items-center justify-content-between mb-4">
				<h1 class="section-title mb-0">
					<i class="fas fa-bell text-primary me-2"></i> Thông báo của tôi
				</h1>
				<div class="btn-group" role="group">
					<a th:href="@{/notifications(unreadOnly=false)}" 
					   th:class="'btn' + (${!unreadOnly} ? ' btn-gold' : ' btn-outline-secondary')">
						<i class="fas fa-list me-1"></i> Tất cả
					</a>
					<a th:href="@{/notifications(unreadOnly=true)}" 
					   th:class="'btn' + (${unreadOnly} ? ' btn-gold' : ' btn-outline-secondary')">
						<i class="fas fa-eye-slash me-1"></i> Chưa đọc (<span th:text="${unreadCount}">0</span>)
					</a>
				</div>
			</div>

		<!-- Empty state -->
		<div th:if="${notifications.empty}" class="empty-state">
			<div class="empty-icon">
				<i class="fas fa-bell-slash"></i>
			</div>
			<h4 class="text-muted mb-3">Không có thông báo nào</h4>
			<p class="text-muted mb-4">Bạn sẽ nhận được thông báo khi có hoạt động mới.</p>
			<a th:href="@{/}" class="btn btn-gold">
				<i class="fas fa-home me-1"></i> Về trang chủ
			</a>
		</div>

		<!-- Notifications List -->
		<div th:if="${!notifications.empty}">
			<div th:each="notification : ${notifications.content}" 
				 th:class="'notification-card p-4' + (${notification.unread} ? ' unread' : '')">
				<div class="d-flex align-items-start">
					<div class="notification-icon me-3" th:text="${notification.type.toString().substring(0,1)}">S</div>
					<div class="flex-grow-1">
						<div class="d-flex justify-content-between align-items-start mb-2">
							<div>
								<h5 class="mb-1 text-white">
									<span th:if="${notification.unread}" class="badge bg-warning text-dark me-2">
										<i class="fas fa-circle me-1"></i>Mới
									</span>
									<span th:text="${notification.title}">Tiêu đề thông báo</span>
								</h5>
								<div class="mb-2">
									<span class="badge badge-role" 
										  th:classappend="${notification.type.name()=='SYSTEM_ANNOUNCEMENT'} ? ' bg-primary' : 
										  (${notification.type.name()=='BOOKING_CONFIRMED'} ? ' bg-success' : 
										  (${notification.type.name()=='BOOKING_CANCELLED'} ? ' bg-danger' : 
										  (${notification.type.name()=='PAYMENT_SUCCESS'} ? ' bg-info' : ' bg-warning')))"
										  th:text="${notification.type}">SYSTEM</span>
									<span th:if="${notification.priority > 0}" class="badge bg-danger badge-status ms-1">
										<i class="fas fa-exclamation-triangle me-1"></i>Ưu tiên cao
									</span>
								</div>
							</div>
							<div class="text-end">
								<a th:href="@{/notifications/{id}(id=${notification.id})}" 
								   class="btn btn-outline-primary btn-sm">
									<i class="fas fa-eye me-1"></i> Xem
								</a>
							</div>
						</div>
						
						<p class="mb-2" style="color: var(--text-dark);" th:text="${#strings.abbreviate(notification.content, 120)}">
							Nội dung thông báo...
						</p>
						
						<div class="d-flex justify-content-between align-items-center">
							<small class="table-muted">
								<i class="fas fa-clock me-1"></i>
								<span th:text="${#temporals.format(notification.publishAt, 'dd/MM/yyyy HH:mm')}">
									01/01/2024 10:00
								</span>
							</small>
							<div th:if="${notification.linkUrl != null and !notification.linkUrl.isEmpty()}">
								<a th:href="${notification.linkUrl}" 
								   class="btn btn-outline-light btn-sm" 
								   target="_blank">
									<i class="fas fa-external-link-alt me-1"></i> Xem thêm
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Pagination -->
		<nav th:if="${totalPages > 1}" class="mt-4" aria-label="Notifications pagination">
			<ul class="pagination justify-content-center">
				<li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
					<a class="page-link" th:href="@{|/notifications?page=${currentPage-1}&unreadOnly=${unreadOnly}|}" aria-label="Previous">
						<span aria-hidden="true">&laquo;</span>
					</a>
				</li>
				<li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages-1)}" th:classappend="${i == currentPage} ? 'active'">
					<a class="page-link" th:text="${i+1}" th:href="@{|/notifications?page=${i}&unreadOnly=${unreadOnly}|}">1</a>
				</li>
				<li class="page-item" th:classappend="${currentPage == totalPages-1} ? 'disabled'">
					<a class="page-link" th:href="@{|/notifications?page=${currentPage+1}&unreadOnly=${unreadOnly}|}" aria-label="Next">
						<span aria-hidden="true">&raquo;</span>
					</a>
				</li>
			</ul>
		</nav>
	</div>

	<div th:replace="~{fragments/design-system-components :: unified-footer}"></div>
	<div th:replace="~{fragments/resy-scripts :: basic-scripts}"></div>
	<script th:src="@{/js/main.js}" defer></script>
</body>
</html> 
