<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Eat – Đặt bàn online, giữ chỗ ngay</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Home Resy Style CSS -->
    <link th:href="@{/css/home-resy.css}" rel="stylesheet">
    <style>
      .nearby-section { display:none; }
      .nearby-grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px,1fr)); gap:16px; }
      .nearby-card { border:1px solid #eee; border-radius:12px; padding:12px; background:#fff; }
      .nearby-card h4 { font-size:1.05rem; margin:0 0 6px; }
      .nearby-meta { font-size:0.9rem; color:#555; display:flex; gap:8px; align-items:center; }
      .nearby-actions { margin-top:8px; }
    </style>
    
</head>
<body>
    
    <!-- Main Header -->
    <header class="header">
        <div class="container">
            <a th:href="@{/}" class="logo">Book Eat</a>
            
            <nav>
                <ul class="nav-menu">
                    <li><a th:href="@{/}" th:classappend="${activeNav == 'home' ? 'active' : ''}">Trang chủ</a></li>
                    <li><a th:href="@{/restaurants}" th:classappend="${activeNav == 'restaurants' ? 'active' : ''}">Nhà hàng</a></li>
                </ul>
            </nav>
            
            <!-- Header Search Dropdown -->
            <div class="header-search">
                <button class="search-toggle" onclick="toggleSearchDropdown()">
                    <i class="fas fa-search"></i>
                </button>
                <div class="search-dropdown" id="searchDropdown">
                    <form th:action="@{/restaurants}" method="get" class="search-form">
                        <div class="search-row">
                            <div class="search-field">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" 
                                       name="search" 
                                       placeholder="Tên nhà hàng, địa chỉ..." 
                                       class="search-input"
                                       th:value="${search}">
                            </div>
                        </div>
                        <div class="search-row">
                            <div class="search-field">
                                <i class="fas fa-utensils search-icon"></i>
                                <select name="cuisineType" class="search-select">
                                    <option value="">Loại ẩm thực</option>
                                    <option value="Vietnamese" th:selected="${cuisineType == 'Vietnamese'}">Việt Nam</option>
                                    <option value="Korean" th:selected="${cuisineType == 'Korean'}">Hàn Quốc</option>
                                    <option value="Japanese" th:selected="${cuisineType == 'Japanese'}">Nhật Bản</option>
                                    <option value="Chinese" th:selected="${cuisineType == 'Chinese'}">Trung Quốc</option>
                                    <option value="Western" th:selected="${cuisineType == 'Western'}">Phương Tây</option>
                                    <option value="Thai" th:selected="${cuisineType == 'Thai'}">Thái Lan</option>
                                    <option value="Italian" th:selected="${cuisineType == 'Italian'}">Ý</option>
                                </select>
                            </div>
                            <div class="search-field">
                                <i class="fas fa-dollar-sign search-icon"></i>
                                <select name="priceRange" class="search-select">
                                    <option value="">Khoảng giá</option>
                                    <option value="under-50k" th:selected="${priceRange == 'under-50k'}">Dưới 50k</option>
                                    <option value="50k-100k" th:selected="${priceRange == '50k-100k'}">50k - 100k</option>
                                    <option value="100k-200k" th:selected="${priceRange == '100k-200k'}">100k - 200k</option>
                                    <option value="over-200k" th:selected="${priceRange == 'over-200k'}">Trên 200k</option>
                                </select>
                            </div>
                        </div>
                        <div class="search-actions">
                            <button type="submit" class="search-submit">
                                <i class="fas fa-search"></i>
                                Tìm kiếm
                            </button>
                            <button type="button" class="search-clear" onclick="clearSearch()">
                                <i class="fas fa-times"></i>
                                Xóa
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="header-actions">
                <!-- Guest User Actions -->
                <a th:href="@{/login}" class="btn-resy-outline" sec:authorize="!isAuthenticated()">Đăng nhập</a>
                <a th:href="@{/auth/register}" class="btn-resy" sec:authorize="!isAuthenticated()">Đăng ký</a>
                
                <!-- Authenticated User Actions -->
                <div sec:authorize="isAuthenticated()" class="user-actions">
                    <!-- Customer Actions -->
                    <a th:href="@{/customer/favorites}" class="btn-resy-outline icon-only" sec:authorize="hasRole('CUSTOMER')" title="Favorites">
                        <i class="fas fa-heart"></i>
                    </a>
                    
                    <!-- Restaurant Owner Dashboard -->
                    <a th:href="@{/restaurant-owner/dashboard}" class="btn-resy" sec:authorize="hasRole('RESTAURANT_OWNER')">
                        <i class="fas fa-tachometer-alt"></i>
                        Dashboard
                    </a>
                    
                    <!-- Admin Dashboard -->
                    <a th:href="@{/admin/dashboard}" class="btn-resy" sec:authorize="hasRole('ADMIN')">
                        <i class="fas fa-cog"></i>
                        Admin
                    </a>
                    
                    <!-- User Profile Dropdown -->
                    <div class="user-dropdown">
                        <button class="btn-resy-outline dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user-circle"></i>
                            <span sec:authentication="name">User</span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li>
                                <a class="dropdown-item" th:href="@{/auth/profile}">
                                    <i class="fas fa-user me-2"></i>
                                    Profile
                                </a>
                            </li>
                            <li sec:authorize="hasRole('CUSTOMER')">
                                <a class="dropdown-item" th:href="@{/booking/my}">
                                    <i class="fas fa-calendar-check me-2"></i>
                                    My Reservations
                                </a>
                            </li>
                            <li sec:authorize="hasRole('CUSTOMER')">
                                <a class="dropdown-item" th:href="@{/customer/favorites}">
                                    <i class="fas fa-heart me-2"></i>
                                    Favorites
                                </a>
                            </li>
                            <li sec:authorize="hasRole('RESTAURANT_OWNER')">
                                <a class="dropdown-item" th:href="@{/restaurant-owner/dashboard}">
                                    <i class="fas fa-tachometer-alt me-2"></i>
                                    Restaurant Dashboard
                                </a>
                            </li>
                            <li sec:authorize="hasRole('ADMIN')">
                                <a class="dropdown-item" th:href="@{/admin/dashboard}">
                                    <i class="fas fa-cog me-2"></i>
                                    Admin Dashboard
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item" th:href="@{/logout}">
                                    <i class="fas fa-sign-out-alt me-2"></i>
                                    Đăng xuất
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Video Hero Section -->
    <section class="video-hero" id="home">
        <div class="video-background">
            <!-- YouTube Video Embed -->
            <iframe 
                src="https://www.youtube.com/embed/xPPLbEFbCAo?autoplay=1&mute=1&loop=1&playlist=xPPLbEFbCAo&controls=0&showinfo=0&rel=0&modestbranding=1"
                frameborder="0"
                allow="autoplay; encrypted-media"
                allowfullscreen>
            </iframe>
        </div>
        <div class="video-overlay">
            <div class="video-content">
                <h1 class="video-title">Khám phá ẩm thực tại Book Eat</h1>
                <p class="video-subtitle">Đặt bàn tại những nhà hàng tốt nhất với Book Eat</p>
                
                
                <div class="video-buttons">
                    <a th:href="@{/restaurants}" class="btn-video">
                        <i class="fas fa-utensils"></i>
                        Khám phá ngay
                    </a>
                    <a href="#intro" class="btn-video-outline">
                        <i class="fas fa-play"></i>
                        Xem thêm
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Intro Section -->
    <section class="intro-section" id="intro">
        <div class="container">
            <div class="intro-container">
                <div class="intro-content">
                    <h2>Nền tảng đặt bàn nhà hàng hàng đầu Việt Nam</h2>
                    <p>
                        Book Eat là giải pháp đặt bàn thông minh, kết nối bạn với hàng ngàn nhà hàng chất lượng cao 
                        trên toàn quốc. Chúng tôi cam kết mang đến trải nghiệm ẩm thực tuyệt vời nhất cho mọi thực khách.
                    </p>
                    <p>
                        Với công nghệ hiện đại và dịch vụ chuyên nghiệp, việc đặt bàn chưa bao giờ dễ dàng đến thế. 
                        Chỉ vài cú click, bạn đã có thể đảm bảo chỗ ngồi tại nhà hàng yêu thích.
                    </p>
                    
                    <div class="intro-features">
                        <div class="intro-feature">
                            <div class="intro-feature-icon">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="intro-feature-text">
                                <h4>Đặt bàn nhanh chóng</h4>
                                <p>Xác nhận tức thì trong vài giây</p>
                            </div>
                        </div>
                        
                        <div class="intro-feature">
                            <div class="intro-feature-icon">
                                <i class="fas fa-shield-alt"></i>
                                </div>
                            <div class="intro-feature-text">
                                <h4>An toàn & Bảo mật</h4>
                                <p>Thông tin được mã hóa bảo mật</p>
                            </div>
                        </div>
                        
                        <div class="intro-feature">
                            <div class="intro-feature-icon">
                                <i class="fas fa-star"></i>
                                </div>
                            <div class="intro-feature-text">
                                <h4>Chất lượng đảm bảo</h4>
                                <p>Nhà hàng được chọn lọc kỹ càng</p>
                            </div>
                        </div>
                        
                        <div class="intro-feature">
                            <div class="intro-feature-icon">
                                <i class="fas fa-headset"></i>
                            </div>
                            <div class="intro-feature-text">
                                <h4>Hỗ trợ 24/7</h4>
                                <p>Luôn sẵn sàng hỗ trợ bạn</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                <div class="intro-image">
                    <!-- YouTube Video Embed -->
                    <iframe 
                        src="https://www.youtube.com/embed/lcU3pruVyUw?autoplay=1&mute=1&loop=1&playlist=lcU3pruVyUw&controls=0&showinfo=0&rel=0&modestbranding=1"
                        frameborder="0"
                        allow="autoplay; encrypted-media"
                        allowfullscreen>
                    </iframe>
                    <div class="intro-video-overlay"></div>
                    <div class="intro-stats">
                        <div class="intro-stat">
                            <span class="intro-stat-number">1,200+</span>
                            <span class="intro-stat-label">Nhà hàng</span>
                        </div>
                        <div class="intro-stat">
                            <span class="intro-stat-number">50K+</span>
                            <span class="intro-stat-label">Khách hàng</span>
                        </div>
                        <div class="intro-stat">
                            <span class="intro-stat-number">4.8</span>
                            <span class="intro-stat-label">Đánh giá</span>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
        </section>

    <!-- Recommended Near You (dynamic) -->
    <section class="nearby-section" id="nearby">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Gợi ý gần bạn</h2>
                <p class="section-subtitle">Nhà hàng gần vị trí hiện tại của bạn</p>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="text-muted small" id="nearbySummary"></div>
                <button class="btn btn-sm btn-outline-secondary" id="btnDisableLocation" type="button">Tắt định vị</button>
            </div>
            <div id="nearbyGrid" class="nearby-grid"></div>
        </div>
    </section>

    <!-- Popular Restaurants -->
    <section class="popular-section" id="restaurants">
            <div class="container">
            <div class="section-header">
                <h2 class="section-title">Nhà hàng phổ biến</h2>
                <p class="section-subtitle">Những nhà hàng được yêu thích nhất</p>
            </div>
            
            <div class="restaurant-grid">
                <div class="restaurant-card">
                    <div class="restaurant-image">
                        <div class="restaurant-badge">Premium</div>
                    </div>
                    <div class="restaurant-info">
                        <h3 class="restaurant-name">Le Bistrot</h3>
                        <p class="restaurant-cuisine">French • Fine Dining</p>
                        <div class="restaurant-rating">
                            <div class="stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="rating-text">4.8 (124 đánh giá)</span>
                        </div>
                        <div class="restaurant-price">$$$$</div>
                        <button class="book-btn">Đặt bàn</button>
                    </div>
                </div>
                
                <div class="restaurant-card">
                    <div class="restaurant-image" style="background: linear-gradient(135deg, #a8e6cf 0%, #88d8c0 100%);">
                        <div class="restaurant-badge">Popular</div>
                    </div>
                    <div class="restaurant-info">
                        <h3 class="restaurant-name">Garden Terrace</h3>
                        <p class="restaurant-cuisine">Asian • Casual</p>
                        <div class="restaurant-rating">
                            <div class="stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="rating-text">4.6 (89 đánh giá)</span>
                        </div>
                        <div class="restaurant-price">$$$</div>
                        <button class="book-btn">Đặt bàn</button>
                    </div>
                                </div>
                
                <div class="restaurant-card">
                    <div class="restaurant-image" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);">
                        <div class="restaurant-badge">New</div>
                                </div>
                    <div class="restaurant-info">
                        <h3 class="restaurant-name">Sky Lounge</h3>
                        <p class="restaurant-cuisine">International • Rooftop</p>
                        <div class="restaurant-rating">
                            <div class="stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="rating-text">4.9 (67 đánh giá)</span>
                        </div>
                        <div class="restaurant-price">$$$$</div>
                        <button class="book-btn">Đặt bàn</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="categories-section" id="categories">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Khám phá theo loại hình</h2>
                <p class="section-subtitle">Tìm nhà hàng phù hợp với sở thích của bạn</p>
            </div>
            
            <div class="category-grid">
                <div class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <h3 class="category-name">Fine Dining</h3>
                    <p class="category-count">45 nhà hàng</p>
                </div>
                
                <div class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-pizza-slice"></i>
                    </div>
                    <h3 class="category-name">Casual Dining</h3>
                    <p class="category-count">128 nhà hàng</p>
                </div>
                
                <div class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-coffee"></i>
                    </div>
                    <h3 class="category-name">Café & Bistro</h3>
                    <p class="category-count">67 nhà hàng</p>
                </div>
                
                <div class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-building"></i>
                    </div>
                    <h3 class="category-name">Rooftop</h3>
                    <p class="category-count">23 nhà hàng</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Restaurant Partners Section -->
    <section class="partners-section">
        <div class="container">
            <div class="partners-intro">
                <h2>Đối tác nhà hàng của chúng tôi</h2>
                <p>Hợp tác với những thương hiệu ẩm thực hàng đầu để mang đến trải nghiệm tuyệt vời nhất</p>
                    </div>
                    
            <div class="partners-grid">
                <!-- Partner 1 -->
                <div class="partner-card">
                    <div class="partner-logo" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-crown"></i>
                    </div>
                    <h3 class="partner-name">Le Cordon Bleu</h3>
                    <p class="partner-type">Fine Dining • French Cuisine</p>
                    <div class="partner-stats">
                        <div class="partner-stat">
                            <div class="partner-stat-number">4.9</div>
                            <div class="partner-stat-label">Rating</div>
                            </div>
                        <div class="partner-stat">
                            <div class="partner-stat-number">350+</div>
                            <div class="partner-stat-label">Reviews</div>
                                </div>
                                </div>
                </div>
                
                <!-- Partner 2 -->
                <div class="partner-card">
                    <div class="partner-logo" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <i class="fas fa-fire"></i>
                    </div>
                    <h3 class="partner-name">Sushi Master</h3>
                    <p class="partner-type">Japanese • Premium</p>
                    <div class="partner-stats">
                        <div class="partner-stat">
                            <div class="partner-stat-number">4.8</div>
                            <div class="partner-stat-label">Rating</div>
                        </div>
                        <div class="partner-stat">
                            <div class="partner-stat-number">280+</div>
                            <div class="partner-stat-label">Reviews</div>
                            </div>
                        </div>
                    </div>
                    
                <!-- Partner 3 -->
                <div class="partner-card">
                    <div class="partner-logo" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-leaf"></i>
                    </div>
                    <h3 class="partner-name">Green Garden</h3>
                    <p class="partner-type">Vegetarian • Organic</p>
                    <div class="partner-stats">
                        <div class="partner-stat">
                            <div class="partner-stat-number">4.7</div>
                            <div class="partner-stat-label">Rating</div>
                            </div>
                        <div class="partner-stat">
                            <div class="partner-stat-number">195+</div>
                            <div class="partner-stat-label">Reviews</div>
                                </div>
                                </div>
                            </div>
                
                <!-- Partner 4 -->
                <div class="partner-card">
                    <div class="partner-logo" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <i class="fas fa-pizza-slice"></i>
                    </div>
                    <h3 class="partner-name">Bella Italia</h3>
                    <p class="partner-type">Italian • Family Style</p>
                    <div class="partner-stats">
                        <div class="partner-stat">
                            <div class="partner-stat-number">4.6</div>
                            <div class="partner-stat-label">Rating</div>
                        </div>
                        <div class="partner-stat">
                            <div class="partner-stat-number">420+</div>
                            <div class="partner-stat-label">Reviews</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Partners CTA -->
            <div class="partners-cta">
                <h3>Bạn là chủ nhà hàng?</h3>
                <p>Hợp tác với Book Eat để tiếp cận hàng ngàn khách hàng tiềm năng mỗi ngày</p>
                <a th:href="@{/auth/register}" class="btn-partner">
                    <i class="fas fa-handshake"></i>
                    Trở thành đối tác
                </a>
                </div>
            </div>
        </section>

    <!-- Footer Video CTA -->
    <section class="footer-video-cta">
        <div class="footer-video-background">
            <!-- YouTube Video Embed -->
            <iframe 
                src="https://www.youtube.com/embed/lcU3pruVyUw?autoplay=1&mute=1&loop=1&playlist=lcU3pruVyUw&controls=0&showinfo=0&rel=0&modestbranding=1"
                frameborder="0"
                allow="autoplay; encrypted-media"
                allowfullscreen>
            </iframe>
        </div>
        <div class="footer-video-overlay">
            <div class="footer-video-content">
                <h2 class="footer-video-title">Bắt đầu trải nghiệm ngay hôm nay</h2>
                <p class="footer-video-subtitle">Đặt bàn nhanh chóng, dễ dàng và miễn phí</p>
                <div class="footer-video-buttons">
                    <a th:href="@{/restaurants}" class="btn-footer-video">
                        <i class="fas fa-calendar-check"></i>
                        Đặt bàn ngay
                    </a>
                    <a th:href="@{/auth/register}" class="btn-footer-video-outline">
                        <i class="fas fa-store"></i>
                        Dành cho nhà hàng
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Resy Footer -->
    <div th:replace="~{fragments/resy-footer :: resy-footer}"></div>

    <!-- Resy Scripts -->
    <div th:replace="~{fragments/resy-scripts :: resy-scripts}"></div>

    <!-- Location Modal Fragment -->
    <div th:insert="~{fragments/location-modal :: location-modal}"></div>

    <!-- Location Feature Bootstrapper -->
    <script th:inline="javascript">
      window.APP_CTX = window.APP_CTX || {};
      APP_CTX.authenticated = /*[[${#authorization.expression('isAuthenticated()')}]]*/ false;
      APP_CTX.isRestaurantOwner = /*[[${#authorization.expression('hasRole(''RESTAURANT_OWNER'')')}]]*/ false;
      APP_CTX.showLocationPrompt = /*[[${session.SHOW_LOCATION_PROMPT}]]*/ false;
      APP_CTX.baseUrl = /*[[@{/}]]*/ '/';
    </script>
    <script th:src="@{/js/location.js}"></script>
    
    <!-- Header Search JavaScript -->
    <script>
        function toggleSearchDropdown() {
            const dropdown = document.getElementById('searchDropdown');
            const isOpen = dropdown.classList.contains('show');
            
            // Close all other dropdowns first
            document.querySelectorAll('.search-dropdown').forEach(dd => {
                dd.classList.remove('show');
            });
            
            // Toggle current dropdown
            if (!isOpen) {
                dropdown.classList.add('show');
                // Focus on search input when opened
                setTimeout(() => {
                    const searchInput = dropdown.querySelector('.search-input');
                    if (searchInput) {
                        searchInput.focus();
                    }
                }, 100);
            }
        }
        
        function clearSearch() {
            const form = document.querySelector('.search-form');
            if (form) {
                form.reset();
            }
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const searchContainer = document.querySelector('.header-search');
            const dropdown = document.getElementById('searchDropdown');
            
            if (!searchContainer.contains(event.target)) {
                dropdown.classList.remove('show');
            }
        });
        
        // Close dropdown on escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const dropdown = document.getElementById('searchDropdown');
                dropdown.classList.remove('show');
            }
        });
    </script>
</body>
</html>
